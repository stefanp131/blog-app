"use strict";(self.webpackChunkblog_fe=self.webpackChunkblog_fe||[]).push([[605],{1605:(Pt,P,m)=>{m.r(P),m.d(P,{PostsModule:()=>Tt});var t=m(4650),A=m(2340),S=m(529);let y=(()=>{class o{constructor(e){this.http=e,this.serviceUrl=A.N.apiUrl+"posts"}getPosts(){return this.http.get(this.serviceUrl)}createPost(e){return this.http.post(this.serviceUrl,e)}getPostById(e){return this.http.get(`${this.serviceUrl}/${e.toString()}`)}updatePostById(e,n){return this.http.put(`${this.serviceUrl}/${e.toString()}`,n)}deletePostById(e){return this.http.delete(`${this.serviceUrl}/${e.toString()}`)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(S.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var f=m(7110),p=m(6895),c=m(3546),d=m(9022),l=m(9499),C=m(7009),x=m(4859),b=m(7392),F=m(266),s=m(1576),_=m(3321),v=m(2382);const L=function(o){return[o]};function U(o,r){if(1&o&&(t.TgZ(0,"button",3)(1,"mat-icon"),t._uU(2,"edit"),t.qZA()()),2&o){const e=t.oxw(2);t.Q6J("routerLink",t.VKq(2,L,e.post.id))("matTooltip","Edit post")}}function w(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.delete())}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}2&o&&t.Q6J("matTooltip","Delete post")}const J=function(o){return[o,"details"]};function E(o,r){if(1&o&&(t.TgZ(0,"mat-card")(1,"span")(2,"i"),t._uU(3,"Summary:"),t.qZA(),t._UZ(4,"br"),t.qZA(),t.TgZ(5,"mat-card-content"),t._uU(6),t.qZA(),t.TgZ(7,"mat-card-footer",1)(8,"div",2)(9,"button",3)(10,"mat-icon"),t._uU(11,"open_in_new"),t.qZA()(),t.YNc(12,U,3,4,"button",4),t.YNc(13,w,3,1,"button",5),t.TgZ(14,"i"),t._uU(15),t.qZA()(),t.TgZ(16,"div")(17,"i"),t._uU(18),t.ALo(19,"utcDateToLocal"),t.qZA(),t._uU(20," \xa0|\xa0 "),t.TgZ(21,"i"),t._uU(22),t.ALo(23,"utcDateToLocal"),t.qZA()()()()),2&o){const e=t.oxw();t.xp6(6),t.Oqu(e.post.summary),t.xp6(3),t.Q6J("routerLink",t.VKq(12,J,e.post.id))("matTooltip","Go to post details"),t.xp6(3),t.Q6J("ngIf",null==e.accountService.currentUserSource.value?null:e.accountService.currentUserSource.value.roles.includes("Admin")),t.xp6(1),t.Q6J("ngIf",null==e.accountService.currentUserSource.value?null:e.accountService.currentUserSource.value.roles.includes("Admin")),t.xp6(2),t.hij("Category: ",e.post.category,""),t.xp6(3),t.hij("Last updated @ ",t.lcZ(19,8,e.post.lastUpdated),""),t.xp6(4),t.hij("Date created @ ",t.lcZ(23,10,e.post.dateCreated),"")}}let q=(()=>{class o{constructor(e,n,a){this.postsService=e,this.snackBar=n,this.accountService=a,this.postDeleted=new t.vpe}set post(e){this._post=e,this.getHTMLFromValue(this._post)}get post(){return this._post}ngOnInit(){}getHTMLFromValue(e){this._post.content=(0,l.io)(JSON.parse(e.content))}delete(){this.postsService.deletePostById(this.post.id).subscribe({next:()=>{this.postDeleted.emit(),this.snackBar.open("Post has been deleted","Dismiss",{duration:5e3})},error:()=>{this.snackBar.open("Something went wrong","Dismiss",{duration:5e3})}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(y),t.Y36(C.ux),t.Y36(f.B))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-post"]],inputs:{post:"post"},outputs:{postDeleted:"postDeleted"},decls:1,vars:1,consts:[[4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between center"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap",".5rem"],["mat-raised-button","","color","accent",3,"routerLink","matTooltip"],["mat-raised-button","","color","accent",3,"routerLink","matTooltip",4,"ngIf"],["mat-raised-button","","color","accent",3,"matTooltip","click",4,"ngIf"],["mat-raised-button","","color","accent",3,"matTooltip","click"]],template:function(e,n){1&e&&t.YNc(0,E,24,14,"mat-card",0),2&e&&t.Q6J("ngIf",n.post)},dependencies:[p.O5,x.lW,c.a8,c.dn,c.rt,b.Hw,F.gM,s.xw,s.SQ,s.Wh,_.rH,v.L],styles:["mat-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{cursor:pointer}mat-card[_ngcontent-%COMP%]   mat-card-footer[_ngcontent-%COMP%]{width:100%;margin:0}"]}),o})();var i=m(4006),g=m(9004),u=m(9549),T=m(4144),D=m(5829);const N=["formDirective"];function Y(o,r){1&o&&t.GkF(0)}function Q(o,r){if(1&o&&(t.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header"),t._uU(2," Create post "),t.qZA(),t.TgZ(3,"mat-panel-description"),t.YNc(4,Y,1,0,"ng-container",2),t.qZA()()),2&o){t.oxw();const e=t.MAs(2);t.xp6(4),t.Q6J("ngTemplateOutlet",e)}}function O(o,r){1&o&&(t.TgZ(0,"mat-card-subtitle"),t._uU(1," Update post "),t.qZA())}function M(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"form",7,8),t.NdJ("ngSubmit",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.createEditPostForm.valid&&a.submit())}),t.TgZ(2,"mat-form-field",9)(3,"mat-label"),t._uU(4,"Title"),t.qZA(),t._UZ(5,"input",10),t.qZA(),t.TgZ(6,"mat-form-field",9)(7,"mat-label"),t._uU(8,"Category"),t.qZA(),t._UZ(9,"input",11),t.qZA(),t.TgZ(10,"mat-form-field",9)(11,"mat-label"),t._uU(12),t.qZA(),t.TgZ(13,"textarea",12),t._uU(14,"          "),t.qZA()(),t.TgZ(15,"div",13),t._UZ(16,"ngx-editor-menu",14)(17,"ngx-editor",15),t.qZA(),t.TgZ(18,"div",16)(19,"button",17),t._uU(20),t.qZA()()()}if(2&o){const e=t.oxw(2);t.Q6J("formGroup",e.createEditPostForm),t.xp6(12),t.hij("Summary (",(null==e.createEditPostForm.get("summary").value?null:e.createEditPostForm.get("summary").value.length)||"0"," / 500)"),t.xp6(4),t.Q6J("editor",e.editor)("toolbar",e.toolbar),t.xp6(1),t.Q6J("editor",e.editor),t.xp6(2),t.Q6J("disabled",!e.createEditPostForm.valid),t.xp6(1),t.hij(" ",e.editPost?"Update":"Create"," ")}}function B(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Fields are required"),t.qZA())}function k(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Maximum length for content is 4000 characters"),t.qZA())}const G=function(o){return{editForm:o}};function j(o,r){if(1&o&&(t.TgZ(0,"mat-card",3),t.YNc(1,O,2,0,"mat-card-subtitle",4),t.TgZ(2,"mat-card-content"),t.YNc(3,M,21,7,"form",5),t.qZA(),t.TgZ(4,"mat-card-footer")(5,"div",6),t.YNc(6,B,2,0,"mat-error",4),t.YNc(7,k,2,0,"mat-error",4),t.qZA()()()),2&o){const e=t.oxw();t.Q6J("ngClass",t.VKq(5,G,e.editPost)),t.xp6(1),t.Q6J("ngIf",e.editPost),t.xp6(2),t.Q6J("ngIf",e.createEditPostForm),t.xp6(3),t.Q6J("ngIf",e.createEditPostForm&&((null==e.createEditPostForm.get("title").errors?null:e.createEditPostForm.get("title").errors.required)||(null==e.createEditPostForm.get("summary").errors?null:e.createEditPostForm.get("summary").errors.required)||(null==e.createEditPostForm.get("category").errors?null:e.createEditPostForm.get("category").errors.required)||(null==e.createEditPostForm.get("content").errors?null:e.createEditPostForm.get("content").errors.required))&&e.createEditPostForm.dirty),t.xp6(1),t.Q6J("ngIf",e.createEditPostForm&&(null==e.createEditPostForm.get("content").errors?null:e.createEditPostForm.get("content").errors.maxlength)&&e.createEditPostForm.dirty)}}let I=(()=>{class o{constructor(e,n,a,h,Zt){this.postsService=e,this.formBuilder=n,this.snackBar=a,this.router=h,this.activatedRoute=Zt,this.postCreated=new t.vpe,this.toolbar=[["bold","italic"],["underline","strike"],["code","blockquote"],["ordered_list","bullet_list"],[{heading:["h1","h2","h3","h4","h5","h6"]}],["link","image"],["text_color","background_color"],["align_left","align_center","align_right","align_justify"]],this.id=this.activatedRoute.snapshot.params.id}ngOnInit(){this.editor=new l.ML({schema:g.fK}),this.id?(this.initEditForm(),console.log("edit")):this.initCreateForm()}ngOnDestroy(){this.editor.destroy()}initCreateForm(){this.createEditPostForm=this.formBuilder.group({title:["",i.kI.required],category:["",i.kI.required],summary:["",i.kI.required],content:["",[l.kI.required(g.fK),l.kI.maxLength(4e3,g.fK)]]})}initEditForm(){this.postsService.getPostById(this.id).subscribe({next:e=>{this.editPost=e,this.createEditPostForm=this.formBuilder.group({title:[this.editPost.title,i.kI.required],category:[this.editPost.category,i.kI.required],summary:[this.editPost.summary,i.kI.required],content:[JSON.parse(this.editPost.content),[l.kI.required(g.fK),l.kI.maxLength(4e3,g.fK)]]})}})}submit(){this.id?this.update():this.create()}update(){const e={...this.createEditPostForm.value};e.content=JSON.stringify(e.content),this.postsService.updatePostById(this.id,e).subscribe({next:()=>{this.router.navigate(["/posts"]),this.snackBar.open("Post has been updated!","Dismiss",{duration:5e3})},error:()=>this.snackBar.open("Something went wrong!","Dismiss",{duration:5e3})})}create(){const e={...this.createEditPostForm.value};e.content=JSON.stringify((0,l.Jg)(e.content)),this.postsService.createPost(e).subscribe({next:()=>{this.formGroupDirective.resetForm(),Object.keys(this.createEditPostForm.controls).forEach(n=>{this.createEditPostForm.controls[n].setErrors(null)}),this.snackBar.open("Post has been created!","Dismiss",{duration:5e3}),this.postCreated.emit()},error:()=>this.snackBar.open("Something went wrong!","Dismiss",{duration:5e3})})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(y),t.Y36(i.qu),t.Y36(C.ux),t.Y36(_.F0),t.Y36(_.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-edit-post"]],viewQuery:function(e,n){if(1&e&&t.Gf(N,5),2&e){let a;t.iGM(a=t.CRH())&&(n.formGroupDirective=a.first)}},outputs:{postCreated:"postCreated"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["edit",""],[4,"ngTemplateOutlet"],[3,"ngClass"],[4,"ngIf"],["fxLayout","column","autocomplete","off",3,"formGroup","ngSubmit",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center"],["fxLayout","column","autocomplete","off",3,"formGroup","ngSubmit"],["formDirective","ngForm"],["appearance","outline","color","accent"],["formControlName","title","matInput","","placeholder","Title"],["formControlName","category","matInput","","placeholder","Category"],["formControlName","summary","matInput","","cols","4","maxlength","500"],[1,"NgxEditor__Wrapper"],[3,"editor","toolbar"],["formControlName","content",3,"editor"],["fxLayoutAlign","center center",1,"submit"],["mat-raised-button","","color","accent",3,"disabled"]],template:function(e,n){if(1&e&&(t.YNc(0,Q,5,1,"mat-expansion-panel",0),t.YNc(1,j,8,7,"ng-template",null,1,t.W1O)),2&e){const a=t.MAs(2);t.Q6J("ngIf",!n.editPost)("ngIfElse",a)}},dependencies:[p.mk,p.O5,p.tP,x.lW,c.a8,c.dn,c.$j,c.rt,u.TO,u.KE,u.hX,T.Nt,d.ib,d.yz,d.u4,s.xw,s.Wh,D.oO,i._Y,i.Fj,i.JJ,i.JL,i.nD,i.sg,i.u,l.tP,l.Mn],styles:["mat-expansion-panel[_ngcontent-%COMP%]{width:76rem;margin:1rem auto;box-shadow:0 0 5px 5px #0003!important}mat-expansion-panel[_ngcontent-%COMP%]   mat-panel-description[_ngcontent-%COMP%]{margin:0;width:100%}mat-expansion-panel[_ngcontent-%COMP%]   mat-panel-description[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{width:100%}.submit[_ngcontent-%COMP%]{width:100%}.submit[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:1rem;width:18rem}.editForm[_ngcontent-%COMP%]{width:80rem;margin:1rem auto;box-shadow:0 0 5px 5px #0003!important}"]}),o})();function H(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"app-create-edit-post",3),t.NdJ("postCreated",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.getPosts())}),t.qZA()}}function K(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header"),t._uU(2),t.qZA(),t.TgZ(3,"mat-panel-description")(4,"app-post",4),t.NdJ("postDeleted",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.getPosts())}),t.qZA()()()}if(2&o){const e=r.$implicit;t.xp6(2),t.hij(" ",e.title," "),t.xp6(2),t.Q6J("post",e)}}let W=(()=>{class o{constructor(e,n){this.postsService=e,this.accountService=n}ngOnInit(){this.getPosts()}getPosts(){this.$posts=this.postsService.getPosts()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(y),t.Y36(f.B))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-posts-list"]],decls:9,vars:4,consts:[[3,"postCreated",4,"ngIf"],[1,"posts-container"],[4,"ngFor","ngForOf"],[3,"postCreated"],[3,"post","postDeleted"]],template:function(e,n){1&e&&(t.YNc(0,H,1,0,"app-create-edit-post",0),t.TgZ(1,"mat-card",1)(2,"mat-card-title"),t._uU(3," Hello friends, here are my posts! "),t.qZA(),t.TgZ(4,"mat-card-content")(5,"mat-accordion"),t.YNc(6,K,5,2,"mat-expansion-panel",2),t.ALo(7,"async"),t.qZA(),t._UZ(8,"app-post"),t.qZA()()),2&e&&(t.Q6J("ngIf",null==n.accountService.currentUserSource.value?null:n.accountService.currentUserSource.value.roles.includes("Admin")),t.xp6(6),t.Q6J("ngForOf",t.lcZ(7,2,n.$posts)))},dependencies:[p.sg,p.O5,c.a8,c.dn,c.n5,d.pp,d.ib,d.yz,d.u4,q,I,p.Ov],styles:[".posts-container[_ngcontent-%COMP%]{width:80%;margin:1rem auto;box-shadow:0 0 5px 5px #0003!important}app-post[_ngcontent-%COMP%]{width:100%}"]}),o})();var Z=m(364),$=m(7296);function z(o,r){if(1&o&&(t.TgZ(0,"mat-card-subtitle",3),t._UZ(1,"img",4),t.TgZ(2,"i"),t._uU(3),t.qZA()()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("src",null!==(n=e.commentary.profilePicture)&&void 0!==n?n:"../../../assets/empty-profile-pic.png",t.LSH),t.xp6(2),t.hij("",e.commentary.createdBy," wrote:")}}function X(o,r){if(1&o&&(t.TgZ(0,"mat-card-content")(1,"b"),t._uU(2),t.qZA(),t._UZ(3,"br"),t._uU(4),t.qZA()),2&o){const e=t.oxw(2);t.xp6(2),t.Oqu(e.commentary.title),t.xp6(2),t.hij(" ",e.commentary.content," ")}}function V(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.toggleApprove())}),t.TgZ(1,"mat-icon"),t._uU(2,"check_circle"),t.qZA()()}2&o&&t.Q6J("matTooltip","Approve commentary")}function R(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.toggleApprove())}),t.TgZ(1,"mat-icon"),t._uU(2,"remove_circle"),t.qZA()()}2&o&&t.Q6J("matTooltip","Reject commentary")}function tt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.initEditForm())}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA()()}2&o&&t.Q6J("matTooltip","Edit commentary")}function et(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.delete())}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}2&o&&t.Q6J("matTooltip","Delete post")}function ot(o,r){if(1&o&&(t.TgZ(0,"mat-card-footer",5)(1,"div",6),t.YNc(2,V,3,1,"button",7),t.YNc(3,R,3,1,"button",7),t.YNc(4,tt,3,1,"button",7),t.YNc(5,et,3,1,"button",7),t.qZA(),t.TgZ(6,"div")(7,"i"),t._uU(8),t.ALo(9,"utcDateToLocal"),t.qZA(),t._uU(10," \xa0|\xa0 "),t.TgZ(11,"i"),t._uU(12),t.ALo(13,"utcDateToLocal"),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",(null==e.accountService.currentUserSource.value?null:e.accountService.currentUserSource.value.roles.includes("Admin"))&&!e.commentary.approved),t.xp6(1),t.Q6J("ngIf",(null==e.accountService.currentUserSource.value?null:e.accountService.currentUserSource.value.roles.includes("Admin"))&&e.commentary.approved),t.xp6(1),t.Q6J("ngIf",(null==e.accountService.currentUserSource.value?null:e.accountService.currentUserSource.value.username)===e.commentary.createdBy),t.xp6(1),t.Q6J("ngIf",(null==e.accountService.currentUserSource.value?null:e.accountService.currentUserSource.value.username)===e.commentary.createdBy),t.xp6(3),t.hij("Last updated @ ",t.lcZ(9,6,e.commentary.lastUpdated),""),t.xp6(4),t.hij("Date created @ ",t.lcZ(13,8,e.commentary.dateCreated),"")}}function nt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"form",10),t.NdJ("ngSubmit",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.commentaryEditForm.valid&&a.submit())}),t.TgZ(1,"mat-form-field",11)(2,"mat-label"),t._uU(3,"Title"),t.qZA(),t._UZ(4,"input",12),t.qZA(),t.TgZ(5,"mat-form-field",11)(6,"mat-label"),t._uU(7),t.qZA(),t.TgZ(8,"textarea",13),t._uU(9,"        "),t.qZA()(),t.TgZ(10,"div",14)(11,"button",15),t._uU(12," Update "),t.qZA(),t.TgZ(13,"button",16),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.cancelForm())}),t._uU(14," Cancel "),t.qZA()()()}if(2&o){const e=t.oxw(3);t.Q6J("formGroup",e.commentaryEditForm),t.xp6(7),t.hij("Your comment (",(null==e.commentaryEditForm.get("content").value?null:e.commentaryEditForm.get("content").value.length)||"0"," / 500)"),t.xp6(4),t.Q6J("disabled",!e.commentaryEditForm.valid)}}function rt(o,r){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,nt,15,3,"form",9),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.commentaryEditForm)}}function at(o,r){if(1&o&&(t.TgZ(0,"mat-card"),t.YNc(1,z,4,2,"mat-card-subtitle",1),t.YNc(2,X,5,2,"mat-card-content",0),t.YNc(3,ot,14,10,"mat-card-footer",2),t.YNc(4,rt,2,1,"div",0),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.showForm),t.xp6(1),t.Q6J("ngIf",!e.showForm),t.xp6(1),t.Q6J("ngIf",!e.showForm),t.xp6(1),t.Q6J("ngIf",e.showForm)}}let it=(()=>{class o{constructor(e,n,a,h){this.commentariesService=e,this.formBuilder=n,this.snackBar=a,this.accountService=h,this.commentaryDeleted=new t.vpe,this.commentaryUpdated=new t.vpe,this.showForm=!1}ngOnInit(){}initEditForm(){this.showForm=!0,this.commentaryEditForm=this.formBuilder.group({title:[this.commentary.title,i.kI.required],content:[this.commentary.content,i.kI.required]})}delete(){this.commentariesService.deleteCommentaryById(this.commentary.id).subscribe({next:()=>{this.commentaryDeleted.emit(),this.snackBar.open("Commentary has been deleted","Dismiss",{duration:5e3})},error:()=>{this.snackBar.open("Something went wrong","Dismiss",{duration:5e3})}})}toggleApprove(){this.commentariesService.approveCommentaryForPost(this.commentary.id,{approved:!this.commentary.approved}).subscribe({next:()=>{this.commentary.approved=!this.commentary.approved,this.snackBar.open("Commentary has been "+(this.commentary.approved?"approved":"rejected"),"Dismiss",{duration:5e3})},error:()=>{this.snackBar.open("Something went wrong","Dismiss",{duration:5e3})}})}submit(){const e={...this.commentaryEditForm.value};this.commentariesService.updateCommentaryForPost(this.commentary.id,e).subscribe({next:()=>{this.commentaryEditForm.reset(),this.showForm=!1,this.snackBar.open("Commentary has been updated!","Dismiss",{duration:5e3}),this.commentaryUpdated.emit()},error:()=>this.snackBar.open("Something went wrong!","Dismiss",{duration:5e3})})}cancelForm(){this.showForm=!1,this.commentaryEditForm.reset()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Z.f),t.Y36(i.qu),t.Y36(C.ux),t.Y36(f.B))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-commentary"]],inputs:{commentary:"commentary"},outputs:{commentaryDeleted:"commentaryDeleted",commentaryUpdated:"commentaryUpdated"},decls:1,vars:1,consts:[[4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between center",4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center"],["alt","Profile Picture",2,"width","5rem","height","5rem","margin","1rem","object-fit","cover","border-radius","50%",3,"src"],["fxLayout","row","fxLayoutAlign","space-between center"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap",".5rem"],["mat-raised-button","","color","accent",3,"matTooltip","click",4,"ngIf"],["mat-raised-button","","color","accent",3,"matTooltip","click"],["fxLayout","column","autocomplete","off",3,"formGroup","ngSubmit",4,"ngIf"],["fxLayout","column","autocomplete","off",3,"formGroup","ngSubmit"],["appearance","outline","color","accent"],["formControlName","title","matInput","","placeholder","Title"],["formControlName","content","matInput","","cols","4","maxlength","500"],["fxLayoutAlign","center center","fxLayoutGap","1.5rem",1,"submit"],["mat-raised-button","","color","accent",3,"disabled"],["type","button","mat-raised-button","","color","accent",3,"click"]],template:function(e,n){1&e&&t.YNc(0,at,5,4,"mat-card",0),2&e&&t.Q6J("ngIf",n.commentary)},dependencies:[p.O5,x.lW,c.a8,c.dn,c.$j,c.rt,u.KE,u.hX,T.Nt,b.Hw,F.gM,s.xw,s.SQ,s.Wh,i._Y,i.Fj,i.JJ,i.JL,i.nD,i.sg,i.u,v.L],styles:["mat-card[_ngcontent-%COMP%]{margin:1rem}mat-card-footer[_ngcontent-%COMP%]{padding:1rem}"]}),o})();const ct=["formDirective"];function mt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"form",3,4),t.NdJ("ngSubmit",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.createCommentaryForm.valid&&a.submit())}),t.TgZ(2,"mat-form-field",5)(3,"mat-label"),t._uU(4,"Title"),t.qZA(),t._UZ(5,"input",6),t.qZA(),t.TgZ(6,"mat-form-field",5)(7,"mat-label"),t._uU(8),t.qZA(),t.TgZ(9,"textarea",7),t._uU(10,"        "),t.qZA()(),t.TgZ(11,"div",8)(12,"button",9),t._uU(13," Create "),t.qZA()()()}if(2&o){const e=t.oxw(2);t.Q6J("formGroup",e.createCommentaryForm),t.xp6(8),t.hij("Your comment (",(null==e.createCommentaryForm.get("content").value?null:e.createCommentaryForm.get("content").value.length)||"0"," / 500)"),t.xp6(4),t.Q6J("disabled",!e.createCommentaryForm.valid)}}function st(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Fields are required"),t.qZA())}function pt(o,r){if(1&o&&(t.TgZ(0,"mat-card")(1,"mat-card-subtitle"),t._uU(2,"Write your opinion"),t.qZA(),t.TgZ(3,"mat-card-content"),t.YNc(4,mt,14,3,"form",1),t.qZA(),t.TgZ(5,"mat-card-footer")(6,"div",2),t.YNc(7,st,2,0,"mat-error",0),t.qZA()()()),2&o){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.createCommentaryForm),t.xp6(3),t.Q6J("ngIf",e.createCommentaryForm&&((null==e.createCommentaryForm.get("title").errors?null:e.createCommentaryForm.get("title").errors.required)||(null==e.createCommentaryForm.get("content").errors?null:e.createCommentaryForm.get("content").errors.required))&&e.createCommentaryForm.dirty)}}let lt=(()=>{class o{constructor(e,n,a,h){this.commentariesService=e,this.formBuilder=n,this.accountService=a,this.snackBar=h,this.commentaryCreated=new t.vpe}ngOnInit(){this.initForm()}initForm(){this.createCommentaryForm=this.formBuilder.group({title:["",i.kI.required],content:["",i.kI.required]})}submit(){const e={...this.createCommentaryForm.value,forPostId:this.postId,createdById:this.accountService.currentUserSource.value.id};this.commentariesService.createCommentaryForPost(e).subscribe({next:()=>{this.formGroupDirective.resetForm(),this.snackBar.open("Commentary has been created! Please await moderation from an admin.","Dismiss",{duration:5e3}),this.commentaryCreated.emit()},error:()=>this.snackBar.open("Something went wrong!","Dismiss",{duration:5e3})})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Z.f),t.Y36(i.qu),t.Y36(f.B),t.Y36(C.ux))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-commentary"]],viewQuery:function(e,n){if(1&e&&t.Gf(ct,5),2&e){let a;t.iGM(a=t.CRH())&&(n.formGroupDirective=a.first)}},inputs:{postId:"postId"},outputs:{commentaryCreated:"commentaryCreated"},decls:1,vars:1,consts:[[4,"ngIf"],["fxLayout","column","autocomplete","off",3,"formGroup","ngSubmit",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center"],["fxLayout","column","autocomplete","off",3,"formGroup","ngSubmit"],["formDirective","ngForm"],["appearance","outline","color","accent"],["formControlName","title","matInput","","placeholder","Title"],["formControlName","content","matInput","","cols","4","maxlength","500"],["fxLayoutAlign","center center",1,"submit"],["mat-raised-button","","color","accent",3,"disabled"]],template:function(e,n){1&e&&t.YNc(0,pt,8,2,"mat-card",0),2&e&&t.Q6J("ngIf",n.postId)},dependencies:[p.O5,x.lW,c.a8,c.dn,c.$j,c.rt,u.TO,u.KE,u.hX,T.Nt,s.xw,s.Wh,i._Y,i.Fj,i.JJ,i.JL,i.nD,i.sg,i.u],styles:["mat-card[_ngcontent-%COMP%]{margin:1rem auto;width:60%;box-shadow:0 0 5px 5px #0003!important}"]}),o})();function ut(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"app-create-commentary",2),t.NdJ("commentaryCreated",function(){t.CHM(e);const a=t.oxw();return a.resetIndex(),t.KtG(a.getCommentariesPerPostList())}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("postId",e.postId)}}function dt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"app-commentary",6),t.NdJ("commentaryUpdated",function(){t.CHM(e);const a=t.oxw(2);return a.resetIndex(),t.KtG(a.getCommentariesPerPostList())})("commentaryDeleted",function(){t.CHM(e);const a=t.oxw(2);return a.resetIndex(),t.KtG(a.getCommentariesPerPostList())}),t.qZA()}2&o&&t.Q6J("commentary",r.$implicit)}function _t(o,r){1&o&&(t.TgZ(0,"mat-card-footer",7)(1,"span"),t._uU(2," No commentaries yet"),t.qZA()())}function ft(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"mat-card",3),t.NdJ("scrolled",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onScroll())}),t.TgZ(1,"mat-card-title"),t._uU(2,"Commentaries"),t.qZA(),t.TgZ(3,"mat-card-content"),t.YNc(4,dt,1,1,"app-commentary",4),t.qZA(),t.YNc(5,_t,3,0,"mat-card-footer",5),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("infiniteScrollDistance",2)("infiniteScrollDisabled",e.disableScroll),t.xp6(4),t.Q6J("ngForOf",e.commentaries),t.xp6(1),t.Q6J("ngIf",e.postId&&0===(null==e.commentaries?null:e.commentaries.length))}}let gt=(()=>{class o{constructor(e,n){this.commentariesService=e,this.accountService=n,this.pageIndex=1,this.pageSize=5}ngOnInit(){this.getCommentariesPerPostList()}getCommentariesPerPostList(e){const n={pageIndex:this.pageIndex,pageSize:this.pageSize,sort:"dateCreatedAsc",search:"",postId:this.postId,approved:!this.accountService.currentUserSource.value?.roles.includes("Admin")};this.commentariesService.getCommentaries(n).subscribe(a=>{e?0===a.data.length?this.disableScroll=!0:this.commentaries.push(...a.data):this.commentaries=a.data})}onScroll(){this.pageIndex++,this.getCommentariesPerPostList(this.pageIndex)}resetIndex(){this.disableScroll=!1,this.pageIndex=1}identify(e,n){return n.id}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Z.f),t.Y36(f.B))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-commentary-list"]],inputs:{postId:"postId"},decls:2,vars:2,consts:[[3,"postId","commentaryCreated",4,"ngIf"],["infinite-scroll","",3,"infiniteScrollDistance","infiniteScrollDisabled","scrolled",4,"ngIf"],[3,"postId","commentaryCreated"],["infinite-scroll","",3,"infiniteScrollDistance","infiniteScrollDisabled","scrolled"],[3,"commentary","commentaryUpdated","commentaryDeleted",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","center center",4,"ngIf"],[3,"commentary","commentaryUpdated","commentaryDeleted"],["fxLayout","row","fxLayoutAlign","center center"]],template:function(e,n){1&e&&(t.YNc(0,ut,1,1,"app-create-commentary",0),t.YNc(1,ft,6,4,"mat-card",1)),2&e&&(t.Q6J("ngIf",n.postId&&n.accountService.currentUserSource.value),t.xp6(1),t.Q6J("ngIf",n.postId))},dependencies:[p.sg,p.O5,c.a8,c.dn,c.n5,c.rt,s.xw,s.Wh,$.Ry,it,lt],styles:["mat-card[_ngcontent-%COMP%]{margin:1rem auto;width:80%;box-shadow:0 0 5px 5px #0003!important}"]}),o})();function ht(o,r){if(1&o&&(t.TgZ(0,"mat-card")(1,"mat-card-title"),t._uU(2),t.qZA(),t._UZ(3,"mat-card-content",2),t.TgZ(4,"mat-card-footer",3)(5,"div")(6,"i"),t._uU(7),t.qZA()(),t.TgZ(8,"div")(9,"i"),t._uU(10),t.ALo(11,"utcDateToLocal"),t.qZA(),t._uU(12," \xa0|\xa0 "),t.TgZ(13,"i"),t._uU(14),t.ALo(15,"utcDateToLocal"),t.qZA()()()()),2&o){const e=t.oxw();t.xp6(2),t.hij(" ",e.post.title,""),t.xp6(1),t.Q6J("innerHTML",e.post.content,t.oJD),t.xp6(4),t.hij("Category: ",e.post.category,""),t.xp6(3),t.hij("Last updated @ ",t.lcZ(11,5,e.post.lastUpdated),""),t.xp6(4),t.hij("Date created @ ",t.lcZ(15,7,e.post.dateCreated),"")}}function yt(o,r){if(1&o&&t._UZ(0,"app-commentary-list",4),2&o){const e=t.oxw();t.Q6J("postId",e.post.id)}}let Ct=(()=>{class o{constructor(e,n,a){this.activatedRoute=e,this.router=n,this.postsService=a,this.id=this.activatedRoute.snapshot.params.id}ngOnInit(){this.postsService.getPostById(this.id).subscribe(e=>{this.post=e,this.post.content=(0,l.io)(JSON.parse(e.content))})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.gz),t.Y36(_.F0),t.Y36(y))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-post-details"]],decls:2,vars:2,consts:[[4,"ngIf"],[3,"postId",4,"ngIf"],[3,"innerHTML"],["fxLayout","row","fxLayoutAlign","space-between center"],[3,"postId"]],template:function(e,n){1&e&&(t.YNc(0,ht,16,9,"mat-card",0),t.YNc(1,yt,1,1,"app-commentary-list",1)),2&e&&(t.Q6J("ngIf",n.post),t.xp6(1),t.Q6J("ngIf",n.post))},dependencies:[p.O5,c.a8,c.dn,c.n5,c.rt,s.xw,s.Wh,gt,v.L],styles:["mat-card[_ngcontent-%COMP%]{margin:1rem auto;width:80%;box-shadow:0 0 5px 5px #0003!important}mat-card[_ngcontent-%COMP%]   mat-card-footer[_ngcontent-%COMP%]{padding:1rem}"]}),o})();var xt=m(2435);const vt=[{path:"",component:W},{path:":id/details",component:Ct},{path:":id",component:I}];let Tt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[xt.m,_.Bz.forChild(vt),_.Bz]}),o})()}}]);